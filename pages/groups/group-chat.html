<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhắn Tin Nhóm - HauHub</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/variables.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/utilities.css">
    <link rel="stylesheet" href="./group-chat.css">
    
    <!-- External Libraries -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
</head>
<body class="chat-page">
    <!-- Header sẽ được inject bởi JS -->
    <header></header>
    
    <!-- Main Chat Container -->
    <main class="chat-main">
        <!-- Left Sidebar - Group List -->
        <aside class="chat-sidebar left-sidebar">
            <div class="sidebar-header">
                <div class="search-box">
                    <span class="search-icon">
                        <span class="material-symbols-outlined">search</span>
                    </span>
                    <input type="text" class="search-input" placeholder="Tìm kiếm Studio...">
                </div>
            </div>
            
            <div class="group-list">
                <!-- Group 1 - Active -->
                <div class="group-item active">
                    <div class="group-icon">
                        <span class="material-symbols-outlined">architecture</span>
                    </div>
                    <div class="group-info">
                        <div class="group-header">
                            <h4 class="group-name">TH4237-22CN3-CÔNG NGHỆ WEB</h4>
                            <span class="group-time">10:45</span>
                        </div>
                        <p class="group-preview">KTS. Nam: "Mọi người cập nhật ..."</p>
                    </div>
                </div>
                
                <!-- Group 2 -->
                <div class="group-item">
                    <div class="group-icon">
                        <span class="material-symbols-outlined">foundation</span>
                    </div>
                    <div class="group-info">
                        <div class="group-header">
                            <h4 class="group-name">TH5257-22CN3-CƠ SỞ DỮ LIỆU</h4>
                            <span class="group-time">HÔM QUA</span>
                        </div>
                        <p class="group-preview">Bạn: Đã gửi một file đính kèm.</p>
                    </div>
                </div>
                
                <!-- Group 3 -->
                <div class="group-item">
                    <div class="group-icon">
                        <span class="material-symbols-outlined">temple_buddhist</span>
                    </div>
                    <div class="group-info">
                        <div class="group-header">
                            <h4 class="group-name">TH3425-22CN3-CẤU TRÚC DỮ LIỆU</h4>
                            <span class="group-time">2 NGÀY</span>
                        </div>
                        <p class="group-preview">Linh: Ảnh khảo sát.</p>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- Main Chat Area -->
        <section class="chat-center">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="header-left">
                    <h3 class="chat-title">TH4237-22CN3-CÔNG NGHỆ WEB</h3>
                    <div class="header-divider"></div>
                    <div class="pinned-docs">
                        <a href="#" class="doc-pin">
                            <span class="material-symbols-outlined">description</span>
                            NHIEM_VU_DO_AN.PDF
                        </a>
                        <a href="#" class="doc-pin">
                            <span class="material-symbols-outlined">link</span>
                            GIÁO TRÌNH MÔN HỌC
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Chat Messages -->
            <div class="chat-messages" id="chat-messages">
                <!-- Date Separator -->
                <div class="date-separator">
                    <span>24 MAY 2024 - SESSION_08</span>
                </div>
                
                <!-- Received Message 1 -->
                <div class="message received">
                    <div class="message-avatar">
                        <div class="avatar-placeholder"></div>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author">TS. HOÀNG NAM</span>
                            <span class="message-time">10:42 AM</span>
                        </div>
                        <div class="message-bubble">
                            <p class="message-text">Mọi người xem qua file nhiệm vụ thiết kế mới nhé.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Sent Message -->
                <div class="message sent">
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-time">10:45 AM</span>
                            <span class="message-author">BẠN</span>
                        </div>
                        <div class="message-bubble">
                            <p class="message-text">Em đã nhận được ạ</p>
                        </div>
                    </div>
                    <div class="message-avatar">
                        <img src="../../assets/images/avatars/current-user.jpg" alt="Your Avatar">
                    </div>
                </div>
                
                <!-- Received Message with Attachment -->
                <div class="message received">
                    <div class="message-avatar">
                        <div class="avatar-placeholder"></div>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author">KHÁNH LINH</span>
                            <span class="message-time">10:48 AM</span>
                        </div>
                        <div class="message-bubble">
                            <p class="message-text">Em có thể áp dụng tỷ lệ này vào khối đế được không thầy?</p>
                            <div class="message-attachment">
                                <div class="attachment-preview">
                                    <div class="preview-bg">
                                        <span class="material-symbols-outlined">architecture</span>
                                    </div>
                                    <div class="attachment-label">REF_DWG_01.JPG</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Message Input -->
            <div class="message-input">
                <div class="input-container">
                    <div class="input-tools">
                        <button class="tool-btn">
                            <span class="material-symbols-outlined">add_circle</span>
                        </button>
                        <button class="tool-btn">
                            <span class="material-symbols-outlined">attach_file</span>
                        </button>
                    </div>
                    <textarea 
                        class="input-field" 
                        placeholder="Nhập tin nhắn nội bộ Studio..." 
                        rows="2"
                        id="message-input"
                    ></textarea>
                    <div class="input-send">
                        <button class="send-btn" id="send-message">
                            <span class="material-symbols-outlined">send</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Right Sidebar - Group Info -->
<!-- Right Sidebar - Group Info -->
<aside class="chat-sidebar right-sidebar">
    <!-- LỚP BỌC ĐỂ CUỘN -->
    <div class="right-sidebar-scroll">

        <!-- Studio Info -->
        <div class="sidebar-section">
            <h3 class="section-title">THÔNG TIN LỚP HỌC</h3>
            <div class="studio-card">
                <div class="card-decor top-right"></div>
                <div class="card-decor bottom-left"></div>
                <div class="card-content">
                    <span class="card-icon">
                        <span class="material-symbols-outlined">apartment</span>
                    </span>
                    <p class="card-label">22CN3<br/>CÔNG NGHỆ WEB</p>
                </div>
            </div>
            <div class="studio-details">
                <div class="detail-item">
                    <span class="detail-label">Mã học phần:</span>
                    <span class="detail-value">TH4123</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Giảng viên:</span>
                    <span class="detail-value">TS. HOÀNG NAM</span>
                </div>
            </div>
        </div>

        <!-- Online Members -->
        <div class="sidebar-section">
            <h3 class="section-title">THÀNH VIÊN</h3>
            <div class="member-list">
                <div class="member-item offline">
                    <div class="member-avatar">
                        <div class="avatar-placeholder"></div>
                        <div class="status-indicator"></div>
                    </div>
                    <div class="member-info">
                        <p class="member-name">Hoàng Nam</p>
                        <p class="member-role">GIẢNG VIÊN HƯỚNG DẪN</p>
                    </div>
                </div>

                <div class="member-item">
                    <div class="member-avatar">
                        <div class="avatar-placeholder"></div>
                        <div class="status-indicator"></div>
                    </div>
                    <div class="member-info">
                        <p class="member-name">Nguyễn Linh</p>
                        <p class="member-role">LỚP TRƯỞNG</p>
                    </div>
                </div>

                <div class="member-item">
                    <div class="member-avatar">
                        <div class="avatar-placeholder"></div>
                    </div>
                    <div class="member-info">
                        <p class="member-name">Trần Minh</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shared Files -->
        <div class="sidebar-section">
            <h3 class="section-title">DỮ LIỆU ĐÃ GỬI</h3>
            <div class="file-grid">
                <div class="file-item">
                    <span class="material-symbols-outlined">image</span>
                </div>
                <div class="file-item">
                    <span class="material-symbols-outlined">picture_as_pdf</span>
                </div>
                <div class="file-item">
                    <span class="material-symbols-outlined">folder_zip</span>
                </div>
            </div>
            <button class="view-all-btn">XEM TẤT CẢ_VIEW_ALL</button>
        </div>

    </div>
</aside>
    </main>
    
    <!-- AI Chat Widget Container -->
    <div id="ai-chat-widget"></div>
    

        <!-- JavaScript Files -->
    <script type="module" src="../../js/components/header.js"></script>
    <script type="module" src="../../js/components/sidebar.js"></script>
    <script type="module" src="../../js/components/chat-widget.js"></script>
    <script type="module" src="../../js/services/chat-service.js"></script>
    <script type="module" src="./group-chat.js"></script>
    <!-- JavaScript Files -->
    <script type="module">
        import { Header } from '../../js/components/header.js';
 
        import { AIChatWidget } from '../../js/components/chat-widget.js';
        import { ChatService } from '../../js/services/chat-service.js';
        
        document.addEventListener('DOMContentLoaded', () => {
            // Tải Header và Footer
            new Header();

            
            // Tải AI Chat Widget
            new AIChatWidget();
            
            // Khởi tạo chat service nếu cần
            if (typeof ChatService !== 'undefined') {
                new ChatService();
            }
            
            // Khởi tạo chức năng chat của trang group-chat
            const chatMessages = document.getElementById('chat-messages');
            const messageInput = document.getElementById('message-input');
            const sendButton = document.getElementById('send-message');
            
            if (sendButton && messageInput) {
                sendButton.addEventListener('click', sendMessage);
                messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
                
                function sendMessage() {
                    const message = messageInput.value.trim();
                    if (message) {
                        // Tạo message element
                        const messageElement = document.createElement('div');
                        messageElement.className = 'message sent';
                        messageElement.innerHTML = `
                            <div class="message-content">
                                <div class="message-header">
                                    <span class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                                    <span class="message-author">BẠN</span>
                                </div>
                                <div class="message-bubble">
                                    <p class="message-text">${message}</p>
                                </div>
                            </div>
                            <div class="message-avatar">
                                <img src="../../assets/images/avatars/current-user.jpg" alt="Your Avatar">
                            </div>
                        `;
                        
                        chatMessages.appendChild(messageElement);
                        messageInput.value = '';
                        
                        // Scroll xuống dưới cùng
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }
                }
            }
        });
    </script>
</body>
</html>